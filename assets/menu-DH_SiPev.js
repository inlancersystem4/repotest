import{w as F,c as N,h as B,o as c,t as K,u as L,a as x,d as k,I as D,l as j,e as O,g as v,v as U,j as $,_ as A,O as _}from"./dialog-Bwww8Fqq.js";import{s as q,p as V,u as H,f as J,c as I}from"./use-text-value-C2hDVVix.js";import{i as Q}from"./use-tree-walker-BsBza9zE.js";import{k as T,l as R,m as h,H as W,q as Z,J as z,I as G,K as X,aO as y}from"./index-CObJ0xdd.js";var Y=(a=>(a[a.Open=0]="Open",a[a.Closed=1]="Closed",a))(Y||{}),ee=(a=>(a[a.Pointer=0]="Pointer",a[a.Other=1]="Other",a))(ee||{});function te(a){requestAnimationFrame(()=>requestAnimationFrame(a))}let E=Symbol("MenuContext");function w(a){let b=X(E,null);if(b===null){let g=new Error(`<${a} /> is missing a parent <Menu /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(g,w),g}return b}let oe=T({name:"Menu",props:{as:{type:[Object,String],default:"template"}},setup(a,{slots:b,attrs:g}){let f=R(1),m=R(null),d=R(null),e=R([]),s=R(""),u=R(null),M=R(1);function S(t=l=>l){let l=u.value!==null?e.value[u.value]:null,n=_(t(e.value.slice()),p=>c(p.dataRef.domRef)),r=l?n.indexOf(l):null;return r===-1&&(r=null),{items:n,activeItemIndex:r}}let o={menuState:f,buttonRef:m,itemsRef:d,items:e,searchQuery:s,activeItemIndex:u,activationTrigger:M,closeMenu:()=>{f.value=1,u.value=null},openMenu:()=>f.value=0,goToItem(t,l,n){let r=S(),p=J(t===I.Specific?{focus:I.Specific,id:l}:{focus:t},{resolveItems:()=>r.items,resolveActiveIndex:()=>r.activeItemIndex,resolveId:i=>i.id,resolveDisabled:i=>i.dataRef.disabled});s.value="",u.value=p,M.value=n??1,e.value=r.items},search(t){let l=s.value!==""?0:1;s.value+=t.toLowerCase();let n=(u.value!==null?e.value.slice(u.value+l).concat(e.value.slice(0,u.value+l)):e.value).find(p=>p.dataRef.textValue.startsWith(s.value)&&!p.dataRef.disabled),r=n?e.value.indexOf(n):-1;r===-1||r===u.value||(u.value=r,M.value=1)},clearSearch(){s.value=""},registerItem(t,l){let n=S(r=>[...r,{id:t,dataRef:l}]);e.value=n.items,u.value=n.activeItemIndex,M.value=1},unregisterItem(t){let l=S(n=>{let r=n.findIndex(p=>p.id===t);return r!==-1&&n.splice(r,1),n});e.value=l.items,u.value=l.activeItemIndex,M.value=1}};return F([m,d],(t,l)=>{var n;o.closeMenu(),N(l,B.Loose)||(t.preventDefault(),(n=c(m))==null||n.focus())},h(()=>f.value===0)),W(E,o),K(h(()=>L(f.value,{0:x.Open,1:x.Closed}))),()=>{let t={open:f.value===0,close:o.closeMenu};return k({ourProps:{},theirProps:a,slot:t,slots:b,attrs:g,name:"Menu"})}}}),re=T({name:"MenuButton",props:{disabled:{type:Boolean,default:!1},as:{type:[Object,String],default:"button"},id:{type:String,default:null}},setup(a,{attrs:b,slots:g,expose:f}){var m;let d=(m=a.id)!=null?m:`headlessui-menu-button-${D()}`,e=w("MenuButton");f({el:e.buttonRef,$el:e.buttonRef});function s(o){switch(o.key){case v.Space:case v.Enter:case v.ArrowDown:o.preventDefault(),o.stopPropagation(),e.openMenu(),y(()=>{var t;(t=c(e.itemsRef))==null||t.focus({preventScroll:!0}),e.goToItem(I.First)});break;case v.ArrowUp:o.preventDefault(),o.stopPropagation(),e.openMenu(),y(()=>{var t;(t=c(e.itemsRef))==null||t.focus({preventScroll:!0}),e.goToItem(I.Last)});break}}function u(o){switch(o.key){case v.Space:o.preventDefault();break}}function M(o){a.disabled||(e.menuState.value===0?(e.closeMenu(),y(()=>{var t;return(t=c(e.buttonRef))==null?void 0:t.focus({preventScroll:!0})})):(o.preventDefault(),e.openMenu(),te(()=>{var t;return(t=c(e.itemsRef))==null?void 0:t.focus({preventScroll:!0})})))}let S=q(h(()=>({as:a.as,type:b.type})),e.buttonRef);return()=>{var o;let t={open:e.menuState.value===0},{...l}=a,n={ref:e.buttonRef,id:d,type:S.value,"aria-haspopup":"menu","aria-controls":(o=c(e.itemsRef))==null?void 0:o.id,"aria-expanded":e.menuState.value===0,onKeydown:s,onKeyup:u,onClick:M};return k({ourProps:n,theirProps:l,slot:t,attrs:b,slots:g,name:"MenuButton"})}}}),se=T({name:"MenuItems",props:{as:{type:[Object,String],default:"div"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null}},setup(a,{attrs:b,slots:g,expose:f}){var m;let d=(m=a.id)!=null?m:`headlessui-menu-items-${D()}`,e=w("MenuItems"),s=R(null);f({el:e.itemsRef,$el:e.itemsRef}),Q({container:h(()=>c(e.itemsRef)),enabled:h(()=>e.menuState.value===0),accept(t){return t.getAttribute("role")==="menuitem"?NodeFilter.FILTER_REJECT:t.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(t){t.setAttribute("role","none")}});function u(t){var l;switch(s.value&&clearTimeout(s.value),t.key){case v.Space:if(e.searchQuery.value!=="")return t.preventDefault(),t.stopPropagation(),e.search(t.key);case v.Enter:if(t.preventDefault(),t.stopPropagation(),e.activeItemIndex.value!==null){let n=e.items.value[e.activeItemIndex.value];(l=c(n.dataRef.domRef))==null||l.click()}e.closeMenu(),A(c(e.buttonRef));break;case v.ArrowDown:return t.preventDefault(),t.stopPropagation(),e.goToItem(I.Next);case v.ArrowUp:return t.preventDefault(),t.stopPropagation(),e.goToItem(I.Previous);case v.Home:case v.PageUp:return t.preventDefault(),t.stopPropagation(),e.goToItem(I.First);case v.End:case v.PageDown:return t.preventDefault(),t.stopPropagation(),e.goToItem(I.Last);case v.Escape:t.preventDefault(),t.stopPropagation(),e.closeMenu(),y(()=>{var n;return(n=c(e.buttonRef))==null?void 0:n.focus({preventScroll:!0})});break;case v.Tab:t.preventDefault(),t.stopPropagation(),e.closeMenu(),y(()=>U(c(e.buttonRef),t.shiftKey?$.Previous:$.Next));break;default:t.key.length===1&&(e.search(t.key),s.value=setTimeout(()=>e.clearSearch(),350));break}}function M(t){switch(t.key){case v.Space:t.preventDefault();break}}let S=j(),o=h(()=>S!==null?(S.value&x.Open)===x.Open:e.menuState.value===0);return()=>{var t,l;let n={open:e.menuState.value===0},{...r}=a,p={"aria-activedescendant":e.activeItemIndex.value===null||(t=e.items.value[e.activeItemIndex.value])==null?void 0:t.id,"aria-labelledby":(l=c(e.buttonRef))==null?void 0:l.id,id:d,onKeydown:u,onKeyup:M,role:"menu",tabIndex:0,ref:e.itemsRef};return k({ourProps:p,theirProps:r,slot:n,attrs:b,slots:g,features:O.RenderStrategy|O.Static,visible:o.value,name:"MenuItems"})}}}),ie=T({name:"MenuItem",inheritAttrs:!1,props:{as:{type:[Object,String],default:"template"},disabled:{type:Boolean,default:!1},id:{type:String,default:null}},setup(a,{slots:b,attrs:g,expose:f}){var m;let d=(m=a.id)!=null?m:`headlessui-menu-item-${D()}`,e=w("MenuItem"),s=R(null);f({el:s,$el:s});let u=h(()=>e.activeItemIndex.value!==null?e.items.value[e.activeItemIndex.value].id===d:!1),M=V(s),S=h(()=>({disabled:a.disabled,get textValue(){return M()},domRef:s}));Z(()=>e.registerItem(d,S)),z(()=>e.unregisterItem(d)),G(()=>{e.menuState.value===0&&u.value&&e.activationTrigger.value!==0&&y(()=>{var i,P;return(P=(i=c(s))==null?void 0:i.scrollIntoView)==null?void 0:P.call(i,{block:"nearest"})})});function o(i){if(a.disabled)return i.preventDefault();e.closeMenu(),A(c(e.buttonRef))}function t(){if(a.disabled)return e.goToItem(I.Nothing);e.goToItem(I.Specific,d)}let l=H();function n(i){l.update(i)}function r(i){l.wasMoved(i)&&(a.disabled||u.value||e.goToItem(I.Specific,d,0))}function p(i){l.wasMoved(i)&&(a.disabled||u.value&&e.goToItem(I.Nothing))}return()=>{let{disabled:i}=a,P={active:u.value,disabled:i,close:e.closeMenu},{...C}=a;return k({ourProps:{id:d,ref:s,role:"menuitem",tabIndex:i===!0?void 0:-1,"aria-disabled":i===!0?!0:void 0,disabled:void 0,onClick:o,onFocus:t,onPointerenter:n,onMouseenter:n,onPointermove:r,onMousemove:r,onPointerleave:p,onMouseleave:p},theirProps:{...g,...C},slot:P,attrs:g,slots:b,name:"MenuItem"})}}});export{ie as M,re as S,se as b,oe as g};
