import{_ as w,b as C,r as d,o as i,d as y,w as v,a as t,g as h,c as l,e as f,F as g,j as p,t as m,E as P,B as M,C as I}from"./index-CObJ0xdd.js";import{f as _}from"./list-fetch-Bs_JyIgH.js";import{i as S}from"./item-delete-BEr_XWGk.js";import{L as N,D as E}from"./Default-BakE7Kt_.js";import{P as B}from"./Pagination-vvzSV-Y8.js";import{L as U}from"./ListPageHeader-DOfYKR_0.js";import{C as j}from"./_baseGetTag-0FFIYyhM.js";import"./transition-DmPYughZ.js";import"./dialog-Bwww8Fqq.js";import"./admin-logo-DCOArUCp.js";import"./menu-DH_SiPev.js";import"./use-text-value-C2hDVVix.js";import"./use-tree-walker-BsBza9zE.js";import"./CommonModalLayout-BJWFpzOf.js";import"./deleteicon-9Y-d_GsD.js";import"./combobox-wrqH_vu8.js";import"./listbox-B5_UOFQ8.js";import"./_commonjsHelpers-BosuxZz1.js";const H={components:{LayoutWrraper:N,Pagination:B,DeleteModal:E,ListPageHeader:U,CalculationsForm:j},data(){return{alertStore:C(),calculationList:[],currentPage:1,totalPages:1,skeletonEffect:!0,calculationId:"",itemNameforDelete:"",deleteModal:!1,calculationsModal:!1,calculationData:"",itemListForForm:[],unitsList:[],ingredientListForForm:[]}},created(){this.fetchcalculationList(),this.fetchIngredientListForForm(),this.fetchUnitsList(),this.fetchItemListForForm()},methods:{updatePage(e){this.currentPage=e,this.fetchcalculationList()},deleteItem(e,a){e&&(this.deleteModal=!0,this.calculationId=e,this.itemNameforDelete=a)},async fetchcalculationList(){this.skeletonEffect=!0,this.calculationList=[];var e=new FormData;e.append("search",""),e.append("page",this.currentPage);const a=await _("calculation-list",e);a&&a.data.length!==0?(this.calculationList=a.data.menu_calculation_lists,this.skeletonEffect=!1,this.totalPages=a.data.total_pages):(this.calculationList=[],this.skeletonEffect=!1)},closeDeleteModal(){this.deleteModal=!1,this.calculationId=""},async deleteCalculation(){if(this.calculationId){var e=new FormData;e.append("calc_id",this.calculationId),await S("calculation-remove",e)?(this.fetchcalculationList(),this.calculationId="",this.closeDeleteModal()):this.closeDeleteModal()}},openCalculationsModal(){this.calculationsModal=!0},closeCalculationsModal(e){this.calculationsModal=!1,e&&this.fetchcalculationList()},async fetchItemListForForm(e){var a=new FormData;e?a.append("search",e):a.append("search","");const o=await _("menuitem-list-for-ingredient",a);o&&o.data.length!==0?this.itemListForForm=o.data:this.itemListForForm=[]},async fetchUnitsList(){var e=new FormData;const a=await _("units-list",e);a&&a.data.length!==0?this.unitsList=a.data:this.unitsList=[]},async fetchIngredientListForForm(e){var a=new FormData;e?a.append("search",e):a.append("search",""),a.append("page","all"),a.append("filter_by_supplier","");const o=await _("ingredient-list",a);o&&o.data.ingredient_lists.length!==0?this.ingredientListForForm=o.data.ingredient_lists:this.ingredientListForForm=[]},async editCalculation(e){var a=new FormData;a.append("calc_id",e);const o=await _("calculation-details",a);o?(this.calculationData=o.data,this.openCalculationsModal()):this.calculationData=""}}},r=e=>(M("data-v-a0a5b0cd"),e=e(),I(),e),V={class:"w-full custom-container mx-auto px-2.5 mt-4 pb-4"},W={class:"table costing--table calculation--table"},z=r(()=>t("tr",null,[t("th",{class:"name"},"Name"),t("th",{class:"link"},"Linked to"),t("th",{class:"sell"},"Selling Price"),t("th",{class:"cost"},"Cost"),t("th",{class:"ratio"},"Ratio"),t("th",{class:"action !text-center"},"Action")],-1)),A=r(()=>t("td",{class:"name"},[t("div",{class:"effect"},[t("span",{class:"bg-base-color h-4 rounded-md w-[140px] mx-auto block"})])],-1)),O=r(()=>t("td",{class:"link"},[t("div",{class:"effect"},[t("span",{class:"bg-base-color h-4 rounded-md mx-auto w-[180px] block"})])],-1)),R=r(()=>t("td",{class:"sell"},[t("div",{class:"effect space-y-1 text-center"},[t("span",{class:"bg-base-color h-4 rounded-md mx-auto w-[120px] block"})])],-1)),G=r(()=>t("td",{class:"cost"},[t("div",{class:"effect space-y-1 text-center"},[t("span",{class:"bg-base-color h-4 rounded-md w-[50px] mx-auto block"})])],-1)),J=r(()=>t("td",{class:"ratio"},[t("div",{class:"effect space-y-1 text-center"},[t("span",{class:"bg-base-color h-4 rounded-md w-[50px] mx-auto block"})])],-1)),K=r(()=>t("td",{class:"action"},[t("div",{class:"effect flex items-center justify-center flex-wrap gap-1.5"},[t("span",{class:"bg-base-color h-4 rounded-md w-[42px] block"})])],-1)),Q=[A,O,R,G,J,K],T=["onClick"],X={class:"name"},Y={class:"link"},Z={key:0},q={key:1},$={class:"sell"},tt={class:"cost"},et={class:"ratio"},at={key:0},st={key:1},ot={class:"action !text-center"},ct=["onClick","disabled"],it={key:1},lt=r(()=>t("td",{class:"!text-center",colspan:"6"},"No data Found!!",-1)),nt=[lt],rt={key:0,class:"flex items-center justify-center w-full mt-8"};function dt(e,a,o,mt,c,n){const L=d("ListPageHeader"),F=d("Pagination"),k=d("DeleteModal"),b=d("CalculationsForm"),D=d("LayoutWrraper");return i(),y(D,null,{default:v(()=>[t("div",V,[h(L,{componentName:"calculation"}),t("table",W,[z,c.skeletonEffect?(i(),l(g,{key:0},f(16,(s,u)=>t("tr",{class:"animate-pulse",key:u},Q)),64)):p("",!0),(i(!0),l(g,null,f(c.calculationList,(s,u)=>(i(),l("tr",{key:u,onClick:x=>n.editCalculation(s.calc_id),class:"cursor-pointer"},[t("td",X,m(s.calc_name),1),t("td",Y,[s.calc_item==="null"||!s.calc_item?(i(),l("span",Z,"-")):(i(),l("span",q,m(s.calc_item),1))]),t("td",$,m(s.calc_price_inc_vat),1),t("td",tt,m(s.calc_cost),1),t("td",et,[s.calc_ratio==="null"||!s.calc_ratio?(i(),l("span",at,"-")):(i(),l("span",st,m(s.calc_ratio),1))]),t("td",ot,[t("button",{onClick:P(x=>n.deleteItem(s.calc_id,s.calc_name),["stop"]),disabled:s.calc_item,class:"disabled:opacity-50"}," Delete ",8,ct)])],8,T))),128)),!c.calculationList||c.calculationList.length===0?(i(),l("tr",it,nt)):p("",!0)]),c.calculationList&&c.calculationList.length!==0?(i(),l("div",rt,[h(F,{currentPage:c.currentPage,totalPages:c.totalPages,onUpdate_page:n.updatePage},null,8,["currentPage","totalPages","onUpdate_page"])])):p("",!0)]),h(k,{isDelete:c.deleteModal,item_name:c.itemNameforDelete,onClose_modal:n.closeDeleteModal,onDelete_item:n.deleteCalculation},null,8,["isDelete","item_name","onClose_modal","onDelete_item"]),h(b,{isOpen:c.calculationsModal,onClose_modal:n.closeCalculationsModal,itemList:this.itemListForForm,packSizeList:this.unitsList,ingredientList:this.ingredientListForForm,onSearch_ingredient:n.fetchIngredientListForForm,onSearch_menu_item:n.fetchItemListForForm,calculation:this.calculationData},null,8,["isOpen","onClose_modal","itemList","packSizeList","ingredientList","onSearch_ingredient","onSearch_menu_item","calculation"])]),_:1})}const It=w(H,[["render",dt],["__scopeId","data-v-a0a5b0cd"]]);export{It as default};
