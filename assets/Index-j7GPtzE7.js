import{_ as k,b as L,f as y,r as _,o as r,d as C,w as D,a as e,y as m,G as g,c as d,j as h,e as M,F as p,n as S,i as u,E as F,t as f,bx as I,B as A,C as V,g as x}from"./index-CObJ0xdd.js";import{f as E}from"./list-fetch-Bs_JyIgH.js";import{i as B}from"./item-delete-BEr_XWGk.js";import{L as O,D as j}from"./Default-BakE7Kt_.js";import{C as W}from"./CommonModalLayout-BJWFpzOf.js";import"./transition-DmPYughZ.js";import"./dialog-Bwww8Fqq.js";import"./admin-logo-DCOArUCp.js";const N="https://stagingapi.fandfrestaurants.com/admin",q={components:{CommonModalLayout:W},props:{isOpen:Boolean,user:Object},data(){return{alertStore:L(),btnLoading:!1,formSubmitted:!1,authoritiesList:[],fullName:"",password:"",uName:"",userId:"",userAuthorities:"",selectedModules:[]}},created(){this.fatchModuleList(),this.updateUserData()},watch:{user(t){t?this.updateUserData():this.clearFields()}},computed:{selectedValues(){return this.selectedModules.join(",")}},methods:{closeModal(){this.$emit("close_modal"),this.clearFields()},clearFields(){this.userId="",this.fullName="",this.password="",this.uName="",this.selectedModules=[],this.formSubmitted=!1},updateUserData(){this.user&&(this.userId=this.user.user_id,this.fullName=this.user.user_first_name,this.password=this.user.user_sweet_words,this.uName=this.user.user_username,this.user.user_module?this.selectedModules=this.user.user_module.split(","):this.selectedModules=[])},async fatchModuleList(){var t=new FormData;try{const s=await y.post(`${N}/module-list`,t);s.data&&s.data.length!==0?this.authoritiesList=s.data:this.authoritiesList=""}catch(s){this.alertStore.error(s)}},async updateUser(){if(this.formSubmitted=!0,this.btnLoading=!0,!this.fullName||!this.password||!this.uName){this.btnLoading=!1;return}var t=new FormData;t.append("user_id",this.userId),t.append("user_fullname",this.fullName),t.append("user_username",this.uName),t.append("user_password",this.password),this.selectedValues?t.append("user_authorities",this.selectedValues):t.append("user_authorities","");try{const s=await y.post(`${N}/add-or-edit-user`,t);s.success==1?(this.$emit("close_modal",1),this.clearFields(),this.formSubmitted=!1,this.btnLoading=!1):(this.alertStore.error(s.message),this.btnLoading=!1)}catch(s){this.alertStore.error(s)}}}},n=t=>(A("data-v-e138fb9c"),t=t(),V(),t),z={class:"space-y-3 w-full"},P={class:"space-y-1"},$={class:"input--group"},T=n(()=>e("label",{for:"fullName"},[u("Full name"),e("span",{class:"text-red-600"},"*")],-1)),G={class:"input--group"},H=n(()=>e("label",null,null,-1)),J={key:0,class:"error--message !text-left flex-1"},K={class:"space-y-1"},Q={class:"input--group"},R=n(()=>e("label",{for:"uName"},[u("Username"),e("span",{class:"text-red-600"},"*")],-1)),X={class:"input--group"},Y=n(()=>e("label",null,null,-1)),Z={key:0,class:"error--message !text-left flex-1"},ee={class:"space-y-1"},se={class:"input--group"},te=n(()=>e("label",{for:"password"},[u("Password"),e("span",{class:"text-red-600"},"*")],-1)),oe={class:"input--group"},le=n(()=>e("label",null,null,-1)),ae={key:0,class:"error--message !text-left flex-1"},re={class:"space-y-1"},ie={class:"input--group !items-start"},de=n(()=>e("label",{for:"authorities"},"Authorities",-1)),ne={class:"w-full border border-solid border-base-color divide-y divide-base-color"},ce={class:"p-2.5"},ue={class:"text-base text-base-color"},me={class:"p-2.5 flex items-end justify-end"},he=["value"],_e=["disabled"],pe={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},fe=n(()=>e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1)),be=n(()=>e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)),we=[fe,be];function ve(t,s,c,U,o,i){const b=_("CommonModalLayout");return r(),C(b,{isOpen:c.isOpen,modal_title:"Add user",onClose_modal:i.closeModal,manualClass:"max-w-xl"},{default:D(()=>[e("form",{class:"space-y-10 flex w-full flex-col items-end",onSubmit:s[4]||(s[4]=F((...l)=>i.updateUser&&i.updateUser(...l),["prevent"]))},[e("div",z,[e("div",P,[e("div",$,[T,m(e("input",{type:"text",id:"fullName","onUpdate:modelValue":s[0]||(s[0]=l=>o.fullName=l)},null,512),[[g,o.fullName,void 0,{trim:!0}]])]),e("div",G,[H,o.formSubmitted&&!o.fullName?(r(),d("p",J," Full Name is required ")):h("",!0)])]),e("div",K,[e("div",Q,[R,m(e("input",{type:"text",id:"uName","onUpdate:modelValue":s[1]||(s[1]=l=>o.uName=l)},null,512),[[g,o.uName,void 0,{trim:!0}]])]),e("div",X,[Y,o.formSubmitted&&!o.uName?(r(),d("p",Z," Username is required ")):h("",!0)])]),e("div",ee,[e("div",se,[te,m(e("input",{type:"text",id:"password","onUpdate:modelValue":s[2]||(s[2]=l=>o.password=l)},null,512),[[g,o.password,void 0,{trim:!0}]])]),e("div",oe,[le,o.formSubmitted&&!o.password?(r(),d("p",ae," Password is required ")):h("",!0)])]),e("div",re,[e("div",ie,[de,e("ul",ne,[(r(!0),d(p,null,M(o.authoritiesList,(l,w)=>(r(),d("li",{class:"grid grid-cols-2 items-center divide-x divide-base-color",key:w},[e("div",ce,[e("p",ue,f(l.module_name),1)]),e("div",me,[m(e("input",{type:"checkbox",value:l.module_id,"onUpdate:modelValue":s[3]||(s[3]=a=>o.selectedModules=a)},null,8,he),[[I,o.selectedModules]])])]))),128))])])])]),e("button",{class:S(["modal--form_btn",{"btn--loader":o.btnLoading}]),type:"submit",disabled:o.btnLoading},[o.btnLoading?(r(),d("svg",pe,we)):h("",!0),u(" Save ")],10,_e)],32)]),_:1},8,["isOpen","onClose_modal"])}const ge=k(q,[["render",ve],["__scopeId","data-v-e138fb9c"]]),xe="https://stagingapi.fandfrestaurants.com/admin",ye={components:{LayoutWrraper:O,UserForm:ge,DeleteModal:j},data(){return{alertStore:L(),listApiName:"user-list",userModal:!1,deleteModal:!1,itemNameforDelete:"",userId:"",userList:[],skeletonEffect:!0,userData:null,deleteApiName:"remove-user"}},created(){this.fetchUserList()},methods:{toggleUserModal(){this.userModal=!this.userModal},closeUserModal(t){this.userModal=!1,t&&this.fetchUserList()},deleteItem(t,s){t&&(this.deleteModal=!0,this.userId=t,this.itemNameforDelete=s)},closeDeleteModal(){this.deleteModal=!1,this.userId=""},async fetchUserList(){this.skeletonEffect=!0;var t=new FormData;const s=await E(this.listApiName,t);s&&s.data.length!==0?(this.userList=s.data,this.skeletonEffect=!1):(this.userList="",this.skeletonEffect=!1)},async updateUser(t){var s=new FormData;s.append("user_id",t);try{const c=await y.post(`${xe}/user-details`,s);c.success==1&&(this.userData=c.data,this.userModal=!0)}catch(c){this.alertStore.error(c)}},async deleteUser(){if(this.userId){var t=new FormData;t.append("user_id",this.userId),await B(this.deleteApiName,t)?(this.fetchUserList(),this.userId="",this.closeDeleteModal()):this.closeDeleteModal()}}}},Me={class:"custom-container"},Ne={class:"flex items-end justify-end w-full"},ke={class:"w-full overflow-x-auto"},Le={class:"table mt-6 users-table w-full"},De=e("tr",null,[e("th",{class:"full-name"},"Full name"),e("th",{class:"userName"},"Username"),e("th",{class:"pass"},"Password"),e("th",{class:"action"},"Action")],-1),Ue=e("td",{class:"full-name"},[e("div",{class:"effect"},[e("span",{class:"bg-base-color h-4 rounded-md w-[240px] block"})])],-1),Ce=e("td",{class:"userName"},[e("div",{class:"effect"},[e("span",{class:"bg-base-color h-4 rounded-md w-[180px] block"})])],-1),Se=e("td",{class:"pass"},[e("div",{class:"effect space-y-1 text-center"},[e("span",{class:"bg-base-color h-4 mx-auto rounded-md w-[120px] block"})])],-1),Fe=e("td",{class:"action"},[e("div",{class:"effect flex items-center justify-center flex-wrap gap-1.5"},[e("span",{class:"bg-base-color h-4 rounded-md w-[42px] block"}),e("span",{class:"bg-base-color h-4 rounded-md w-[42px] block"})])],-1),Ie=[Ue,Ce,Se,Fe],Ae={key:1},Ve=e("td",{colspan:"4",class:"!text-center"},"No Data Available",-1),Ee=[Ve],Be={class:"full-name !normal-case"},Oe={class:"userName !normal-case"},je={class:"pass !normal-case"},We={class:"action"},qe=["onClick"],ze=["onClick"];function Pe(t,s,c,U,o,i){const b=_("LayoutWrraper"),l=_("UserForm"),w=_("DeleteModal");return r(),d(p,null,[x(b,null,{default:D(()=>[e("div",Me,[e("div",Ne,[e("button",{class:"btn--regular",onClick:s[0]||(s[0]=(...a)=>i.toggleUserModal&&i.toggleUserModal(...a))},"Add")]),e("div",ke,[e("table",Le,[De,o.skeletonEffect?(r(),d(p,{key:0},M(16,(a,v)=>e("tr",{class:"animate-pulse",key:v},Ie)),64)):o.userList.length===0?(r(),d("tr",Ae,Ee)):(r(!0),d(p,{key:2},M(o.userList,a=>(r(),d("tr",{key:a.user_id},[e("td",Be,f(a.user_first_name),1),e("td",Oe,f(a.user_username),1),e("td",je,f(a.user_sweet_words),1),e("td",We,[e("button",{onClick:v=>i.updateUser(a.user_id)},"Edit",8,qe),u(", "),e("button",{onClick:v=>i.deleteItem(a.user_id,a.user_username)},"Delete",8,ze)])]))),128))])])])]),_:1}),x(l,{isOpen:o.userModal,onClose_modal:i.closeUserModal,user:o.userData},null,8,["isOpen","onClose_modal","user"]),x(w,{isDelete:o.deleteModal,item_name:o.itemNameforDelete,onClose_modal:i.closeDeleteModal,onDelete_item:i.deleteUser},null,8,["isDelete","item_name","onClose_modal","onDelete_item"])],64)}const Xe=k(ye,[["render",Pe]]);export{Xe as default};
