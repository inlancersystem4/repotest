import{m as x,A as q,be as fe,p as B,bp as le,aY as he,k as K,l as V,b1 as pe,H as ae,q as X,v as H,F as me,I as J,K as se,J as be,a7 as ge,bk as _,aO as ue}from"./index-CObJ0xdd.js";import{d as xe,e as Oe}from"./listbox-B5_UOFQ8.js";import{u as j,o as T,w as Ie,t as Se,a as W,f as ye,m as Te,s as Ce,d as Z,p as ee,I as te,i as Ee,e as Y,l as Re,O as Me,q as ne,g as A,r as oe,x as we}from"./dialog-Bwww8Fqq.js";import{c as P,f as ie,u as ze}from"./use-text-value-C2hDVVix.js";import{i as Pe}from"./use-tree-walker-BsBza9zE.js";function N(n,c,e){let o=e.initialDeps??[],t;return()=>{var i,u,l,v;let f;e.key&&((i=e.debug)!=null&&i.call(e))&&(f=Date.now());const b=n();if(!(b.length!==o.length||b.some((R,M)=>o[M]!==R)))return t;o=b;let E;if(e.key&&((u=e.debug)!=null&&u.call(e))&&(E=Date.now()),t=c(...b),e.key&&((l=e.debug)!=null&&l.call(e))){const R=Math.round((Date.now()-f)*100)/100,M=Math.round((Date.now()-E)*100)/100,F=M/16,D=(h,O)=>{for(h=String(h);h.length<O;)h=" "+h;return h};console.info(`%c⏱ ${D(M,5)} /${D(R,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*F,120))}deg 100% 31%);`,e==null?void 0:e.key)}return(v=e==null?void 0:e.onChange)==null||v.call(e,t),t}}function Q(n,c){if(n===void 0)throw new Error(`Unexpected undefined${c?`: ${c}`:""}`);return n}const Fe=(n,c)=>Math.abs(n-c)<1,ke=n=>n,Ve=n=>{const c=Math.max(n.startIndex-n.overscan,0),e=Math.min(n.endIndex+n.overscan,n.count-1),o=[];for(let t=c;t<=e;t++)o.push(t);return o},De=(n,c)=>{const e=n.scrollElement;if(!e)return;const o=i=>{const{width:u,height:l}=i;c({width:Math.round(u),height:Math.round(l)})};if(o(e.getBoundingClientRect()),typeof ResizeObserver>"u")return()=>{};const t=new ResizeObserver(i=>{const u=i[0];if(u!=null&&u.borderBoxSize){const l=u.borderBoxSize[0];if(l){o({width:l.inlineSize,height:l.blockSize});return}}o(e.getBoundingClientRect())});return t.observe(e,{box:"border-box"}),()=>{t.unobserve(e)}},$e=(n,c)=>{const e=n.scrollElement;if(!e)return;const o=()=>{c(e[n.options.horizontal?"scrollLeft":"scrollTop"])};return o(),e.addEventListener("scroll",o,{passive:!0}),()=>{e.removeEventListener("scroll",o)}},Ae=(n,c,e)=>{if(c!=null&&c.borderBoxSize){const o=c.borderBoxSize[0];if(o)return Math.round(o[e.options.horizontal?"inlineSize":"blockSize"])}return Math.round(n.getBoundingClientRect()[e.options.horizontal?"width":"height"])},_e=(n,{adjustments:c=0,behavior:e},o)=>{var t,i;const u=n+c;(i=(t=o.scrollElement)==null?void 0:t.scrollTo)==null||i.call(t,{[o.options.horizontal?"left":"top"]:u,behavior:e})};class Be{constructor(c){this.unsubs=[],this.scrollElement=null,this.isScrolling=!1,this.isScrollingTimeoutId=null,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollDirection=null,this.scrollAdjustments=0,this.measureElementCache=new Map,this.observer=(()=>{let e=null;const o=()=>e||(typeof ResizeObserver<"u"?e=new ResizeObserver(t=>{t.forEach(i=>{this._measureElement(i.target,i)})}):null);return{disconnect:()=>{var t;return(t=o())==null?void 0:t.disconnect()},observe:t=>{var i;return(i=o())==null?void 0:i.observe(t,{box:"border-box"})},unobserve:t=>{var i;return(i=o())==null?void 0:i.unobserve(t)}}})(),this.range=null,this.setOptions=e=>{Object.entries(e).forEach(([o,t])=>{typeof t>"u"&&delete e[o]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:ke,rangeExtractor:Ve,onChange:()=>{},measureElement:Ae,initialRect:{width:0,height:0},scrollMargin:0,scrollingDelay:150,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,...e}},this.notify=e=>{var o,t;(t=(o=this.options).onChange)==null||t.call(o,this,e)},this.maybeNotify=N(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),e=>{this.notify(e)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(e=>e()),this.unsubs=[],this.scrollElement=null},this._didMount=()=>(this.measureElementCache.forEach(this.observer.observe),()=>{this.observer.disconnect(),this.cleanup()}),this._willUpdate=()=>{const e=this.options.getScrollElement();this.scrollElement!==e&&(this.cleanup(),this.scrollElement=e,this._scrollToOffset(this.scrollOffset,{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,o=>{this.scrollRect=o,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,o=>{this.scrollAdjustments=0,this.scrollOffset!==o&&(this.isScrollingTimeoutId!==null&&(clearTimeout(this.isScrollingTimeoutId),this.isScrollingTimeoutId=null),this.isScrolling=!0,this.scrollDirection=this.scrollOffset<o?"forward":"backward",this.scrollOffset=o,this.maybeNotify(),this.isScrollingTimeoutId=setTimeout(()=>{this.isScrollingTimeoutId=null,this.isScrolling=!1,this.scrollDirection=null,this.maybeNotify()},this.options.scrollingDelay))})))},this.getSize=()=>this.scrollRect[this.options.horizontal?"width":"height"],this.memoOptions=N(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey],(e,o,t,i)=>(this.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:o,scrollMargin:t,getItemKey:i}),{key:!1}),this.getFurthestMeasurement=(e,o)=>{const t=new Map,i=new Map;for(let u=o-1;u>=0;u--){const l=e[u];if(t.has(l.lane))continue;const v=i.get(l.lane);if(v==null||l.end>v.end?i.set(l.lane,l):l.end<v.end&&t.set(l.lane,!0),t.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((u,l)=>u.end===l.end?u.index-l.index:u.end-l.end)[0]:void 0},this.getMeasurements=N(()=>[this.memoOptions(),this.itemSizeCache],({count:e,paddingStart:o,scrollMargin:t,getItemKey:i},u)=>{const l=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const v=this.measurementsCache.slice(0,l);for(let f=l;f<e;f++){const b=i(f),g=this.options.lanes===1?v[f-1]:this.getFurthestMeasurement(v,f),E=g?g.end:o+t,R=u.get(b),M=typeof R=="number"?R:this.options.estimateSize(f),F=E+M,D=g?g.lane:f%this.options.lanes;v[f]={index:f,start:E,size:M,end:F,key:b,lane:D}}return this.measurementsCache=v,v},{key:!1,debug:()=>this.options.debug}),this.calculateRange=N(()=>[this.getMeasurements(),this.getSize(),this.scrollOffset],(e,o,t)=>this.range=e.length>0&&o>0?Ne({measurements:e,outerSize:o,scrollOffset:t}):null,{key:!1,debug:()=>this.options.debug}),this.getIndexes=N(()=>[this.options.rangeExtractor,this.calculateRange(),this.options.overscan,this.options.count],(e,o,t,i)=>o===null?[]:e({...o,overscan:t,count:i}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=e=>{const o=this.options.indexAttribute,t=e.getAttribute(o);return t?parseInt(t,10):(console.warn(`Missing attribute name '${o}={index}' on measured element.`),-1)},this._measureElement=(e,o)=>{const t=this.measurementsCache[this.indexFromElement(e)];if(!t||!e.isConnected){this.measureElementCache.forEach((l,v)=>{l===e&&(this.observer.unobserve(e),this.measureElementCache.delete(v))});return}const i=this.measureElementCache.get(t.key);i!==e&&(i&&this.observer.unobserve(i),this.observer.observe(e),this.measureElementCache.set(t.key,e));const u=this.options.measureElement(e,o,this);this.resizeItem(t,u)},this.resizeItem=(e,o)=>{const t=this.itemSizeCache.get(e.key)??e.size,i=o-t;i!==0&&(e.start<this.scrollOffset+this.scrollAdjustments&&this._scrollToOffset(this.scrollOffset,{adjustments:this.scrollAdjustments+=i,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(e.index),this.itemSizeCache=new Map(this.itemSizeCache.set(e.key,o)),this.notify(!1))},this.measureElement=e=>{e&&this._measureElement(e,void 0)},this.getVirtualItems=N(()=>[this.getIndexes(),this.getMeasurements()],(e,o)=>{const t=[];for(let i=0,u=e.length;i<u;i++){const l=e[i],v=o[l];t.push(v)}return t},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=e=>{const o=this.getMeasurements();return Q(o[re(0,o.length-1,t=>Q(o[t]).start,e)])},this.getOffsetForAlignment=(e,o)=>{const t=this.getSize();o==="auto"&&(e<=this.scrollOffset?o="start":e>=this.scrollOffset+t?o="end":o="start"),o==="start"?e=e:o==="end"?e=e-t:o==="center"&&(e=e-t/2);const i=this.options.horizontal?"scrollWidth":"scrollHeight",l=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[i]:this.scrollElement[i]:0)-this.getSize();return Math.max(Math.min(l,e),0)},this.getOffsetForIndex=(e,o="auto")=>{e=Math.max(0,Math.min(e,this.options.count-1));const t=Q(this.getMeasurements()[e]);if(o==="auto")if(t.end>=this.scrollOffset+this.getSize()-this.options.scrollPaddingEnd)o="end";else if(t.start<=this.scrollOffset+this.options.scrollPaddingStart)o="start";else return[this.scrollOffset,o];const i=o==="end"?t.end+this.options.scrollPaddingEnd:t.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(i,o),o]},this.isDynamicMode=()=>this.measureElementCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&(clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(e,{align:o="start",behavior:t}={})=>{this.cancelScrollToIndex(),t==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(e,o),{adjustments:void 0,behavior:t})},this.scrollToIndex=(e,{align:o="auto",behavior:t}={})=>{e=Math.max(0,Math.min(e,this.options.count-1)),this.cancelScrollToIndex(),t==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const[i,u]=this.getOffsetForIndex(e,o);this._scrollToOffset(i,{adjustments:void 0,behavior:t}),t!=="smooth"&&this.isDynamicMode()&&(this.scrollToIndexTimeoutId=setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.measureElementCache.has(this.options.getItemKey(e))){const[v]=this.getOffsetForIndex(e,u);Fe(v,this.scrollOffset)||this.scrollToIndex(e,{align:u,behavior:t})}else this.scrollToIndex(e,{align:u,behavior:t})}))},this.scrollBy=(e,{behavior:o}={})=>{this.cancelScrollToIndex(),o==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.scrollOffset+e,{adjustments:void 0,behavior:o})},this.getTotalSize=()=>{var e;const o=this.getMeasurements();let t;return o.length===0?t=this.options.paddingStart:t=this.options.lanes===1?((e=o[o.length-1])==null?void 0:e.end)??0:Math.max(...o.slice(-this.options.lanes).map(i=>i.end)),t-this.options.scrollMargin+this.options.paddingEnd},this._scrollToOffset=(e,{adjustments:o,behavior:t})=>{this.options.scrollToFn(e,{behavior:t,adjustments:o},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(c),this.scrollRect=this.options.initialRect,this.scrollOffset=this.options.initialOffset,this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(e=>{this.itemSizeCache.set(e.key,e.size)}),this.maybeNotify()}}const re=(n,c,e,o)=>{for(;n<=c;){const t=(n+c)/2|0,i=e(t);if(i<o)n=t+1;else if(i>o)c=t-1;else return t}return n>0?n-1:0};function Ne({measurements:n,outerSize:c,scrollOffset:e}){const o=n.length-1,i=re(0,o,l=>n[l].start,e);let u=i;for(;u<o&&n[u].end<e+c;)u++;return{startIndex:i,endIndex:u}}function je(n){const c=new Be(q(n)),e=fe(c),o=c._didMount();return B(()=>q(n).getScrollElement(),t=>{t&&c._willUpdate()},{immediate:!0}),B(()=>q(n),t=>{c.setOptions({...t,onChange:(i,u)=>{var l;le(e),(l=t.onChange)==null||l.call(t,i,u)}}),c._willUpdate(),le(e)},{immediate:!0}),he(o),e}function Le(n){return je(x(()=>({observeElementRect:De,observeElementOffset:$e,scrollToFn:_e,...q(n)})))}var Ke={};function Ue(n,c){return n===c}var qe=(n=>(n[n.Open=0]="Open",n[n.Closed=1]="Closed",n))(qe||{}),He=(n=>(n[n.Single=0]="Single",n[n.Multi=1]="Multi",n))(He||{}),Je=(n=>(n[n.Pointer=0]="Pointer",n[n.Focus=1]="Focus",n[n.Other=2]="Other",n))(Je||{});let de=Symbol("ComboboxContext");function U(n){let c=se(de,null);if(c===null){let e=new Error(`<${n} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(e,U),e}return c}let ce=Symbol("VirtualContext"),We=K({name:"VirtualProvider",setup(n,{slots:c}){let e=U("VirtualProvider"),o=x(()=>{let l=T(e.optionsRef);if(!l)return{start:0,end:0};let v=window.getComputedStyle(l);return{start:parseFloat(v.paddingBlockStart||v.paddingTop),end:parseFloat(v.paddingBlockEnd||v.paddingBottom)}}),t=Le(x(()=>({scrollPaddingStart:o.value.start,scrollPaddingEnd:o.value.end,count:e.virtual.value.options.length,estimateSize(){return 40},getScrollElement(){return T(e.optionsRef)},overscan:12}))),i=x(()=>{var l;return(l=e.virtual.value)==null?void 0:l.options}),u=V(0);return B([i],()=>{u.value+=1}),ae(ce,e.virtual.value?t:null),()=>[H("div",{style:{position:"relative",width:"100%",height:`${t.value.getTotalSize()}px`},ref:l=>{if(l){if(typeof process<"u"&&Ke.JEST_WORKER_ID!==void 0||e.activationTrigger.value===0)return;e.activeOptionIndex.value!==null&&e.virtual.value.options.length>e.activeOptionIndex.value&&t.value.scrollToIndex(e.activeOptionIndex.value)}}},t.value.getVirtualItems().map(l=>ge(c.default({option:e.virtual.value.options[l.index],open:e.comboboxState.value===0})[0],{key:`${u.value}-${l.index}`,"data-index":l.index,"aria-setsize":e.virtual.value.options.length,"aria-posinset":l.index+1,style:{position:"absolute",top:0,left:0,transform:`translateY(${l.start}px)`,overflowAnchor:"none"}})))]}}),et=K({name:"Combobox",emits:{"update:modelValue":n=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],nullable:!0,default:null},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},form:{type:String,optional:!0},name:{type:String,optional:!0},nullable:{type:Boolean,default:!1},multiple:{type:[Boolean],default:!1},immediate:{type:[Boolean],default:!1},virtual:{type:Object,default:null}},inheritAttrs:!1,setup(n,{slots:c,attrs:e,emit:o}){let t=V(1),i=V(null),u=V(null),l=V(null),v=V(null),f=V({static:!1,hold:!1}),b=V([]),g=V(null),E=V(2),R=V(!1);function M(s=d=>d){let d=g.value!==null?b.value[g.value]:null,p=s(b.value.slice()),m=p.length>0&&p[0].dataRef.order.value!==null?p.sort((C,$)=>C.dataRef.order.value-$.dataRef.order.value):Me(p,C=>T(C.dataRef.domRef)),y=d?m.indexOf(d):null;return y===-1&&(y=null),{options:m,activeOptionIndex:y}}let F=x(()=>n.multiple?1:0),D=x(()=>n.nullable),[h,O]=xe(x(()=>n.modelValue),s=>o("update:modelValue",s),x(()=>n.defaultValue)),k=x(()=>h.value===void 0?j(F.value,{1:[],0:void 0}):h.value),r=null,S=null;function I(s){return j(F.value,{0(){return O==null?void 0:O(s)},1:()=>{let d=_(a.value.value).slice(),p=_(s),m=d.findIndex(y=>a.compare(p,_(y)));return m===-1?d.push(p):d.splice(m,1),O==null?void 0:O(d)}})}let w=x(()=>{});B([w],([s],[d])=>{if(a.virtual.value&&s&&d&&g.value!==null){let p=s.indexOf(d[g.value]);p!==-1?g.value=p:g.value=null}});let a={comboboxState:t,value:k,mode:F,compare(s,d){if(typeof n.by=="string"){let p=n.by;return(s==null?void 0:s[p])===(d==null?void 0:d[p])}return n.by===null?Ue(s,d):n.by(s,d)},calculateIndex(s){return a.virtual.value?n.by===null?a.virtual.value.options.indexOf(s):a.virtual.value.options.findIndex(d=>a.compare(d,s)):b.value.findIndex(d=>a.compare(d.dataRef.value,s))},defaultValue:x(()=>n.defaultValue),nullable:D,immediate:x(()=>!1),virtual:x(()=>null),inputRef:u,labelRef:i,buttonRef:l,optionsRef:v,disabled:x(()=>n.disabled),options:b,change(s){O(s)},activeOptionIndex:x(()=>{if(R.value&&g.value===null&&(a.virtual.value?a.virtual.value.options.length>0:b.value.length>0)){if(a.virtual.value){let d=a.virtual.value.options.findIndex(p=>{var m;return!((m=a.virtual.value)!=null&&m.disabled(p))});if(d!==-1)return d}let s=b.value.findIndex(d=>!d.dataRef.disabled);if(s!==-1)return s}return g.value}),activationTrigger:E,optionsPropsRef:f,closeCombobox(){R.value=!1,!n.disabled&&t.value!==1&&(t.value=1,g.value=null)},openCombobox(){if(R.value=!0,!n.disabled&&t.value!==0){if(a.value.value){let s=a.calculateIndex(a.value.value);s!==-1&&(g.value=s)}t.value=0}},setActivationTrigger(s){E.value=s},goToOption(s,d,p){R.value=!1,r!==null&&cancelAnimationFrame(r),r=requestAnimationFrame(()=>{if(n.disabled||v.value&&!f.value.static&&t.value===1)return;if(a.virtual.value){g.value=s===P.Specific?d:ie({focus:s},{resolveItems:()=>a.virtual.value.options,resolveActiveIndex:()=>{var C,$;return($=(C=a.activeOptionIndex.value)!=null?C:a.virtual.value.options.findIndex(G=>{var L;return!((L=a.virtual.value)!=null&&L.disabled(G))}))!=null?$:null},resolveDisabled:C=>a.virtual.value.disabled(C),resolveId(){throw new Error("Function not implemented.")}}),E.value=p??2;return}let m=M();if(m.activeOptionIndex===null){let C=m.options.findIndex($=>!$.dataRef.disabled);C!==-1&&(m.activeOptionIndex=C)}let y=s===P.Specific?d:ie({focus:s},{resolveItems:()=>m.options,resolveActiveIndex:()=>m.activeOptionIndex,resolveId:C=>C.id,resolveDisabled:C=>C.dataRef.disabled});g.value=y,E.value=p??2,b.value=m.options})},selectOption(s){let d=b.value.find(m=>m.id===s);if(!d)return;let{dataRef:p}=d;I(p.value)},selectActiveOption(){if(a.activeOptionIndex.value!==null){if(a.virtual.value)I(a.virtual.value.options[a.activeOptionIndex.value]);else{let{dataRef:s}=b.value[a.activeOptionIndex.value];I(s.value)}a.goToOption(P.Specific,a.activeOptionIndex.value)}},registerOption(s,d){let p=pe({id:s,dataRef:d});if(a.virtual.value){b.value.push(p);return}S&&cancelAnimationFrame(S);let m=M(y=>(y.push(p),y));g.value===null&&a.isSelected(d.value.value)&&(m.activeOptionIndex=m.options.indexOf(p)),b.value=m.options,g.value=m.activeOptionIndex,E.value=2,m.options.some(y=>!T(y.dataRef.domRef))&&(S=requestAnimationFrame(()=>{let y=M();b.value=y.options,g.value=y.activeOptionIndex}))},unregisterOption(s,d){if(r!==null&&cancelAnimationFrame(r),d&&(R.value=!0),a.virtual.value){b.value=b.value.filter(m=>m.id!==s);return}let p=M(m=>{let y=m.findIndex(C=>C.id===s);return y!==-1&&m.splice(y,1),m});b.value=p.options,g.value=p.activeOptionIndex,E.value=2},isSelected(s){return j(F.value,{0:()=>a.compare(_(a.value.value),_(s)),1:()=>_(a.value.value).some(d=>a.compare(_(d),_(s)))})},isActive(s){return g.value===a.calculateIndex(s)}};Ie([u,l,v],()=>a.closeCombobox(),x(()=>t.value===0)),ae(de,a),Se(x(()=>j(t.value,{0:W.Open,1:W.Closed})));let z=x(()=>{var s;return(s=T(u))==null?void 0:s.closest("form")});return X(()=>{B([z],()=>{if(!z.value||n.defaultValue===void 0)return;function s(){a.change(n.defaultValue)}return z.value.addEventListener("reset",s),()=>{var d;(d=z.value)==null||d.removeEventListener("reset",s)}},{immediate:!0})}),()=>{var s,d,p;let{name:m,disabled:y,form:C,...$}=n,G={open:t.value===0,disabled:y,activeIndex:a.activeOptionIndex.value,activeOption:a.activeOptionIndex.value===null?null:a.virtual.value?a.virtual.value.options[(s=a.activeOptionIndex.value)!=null?s:0]:(p=(d=a.options.value[a.activeOptionIndex.value])==null?void 0:d.dataRef.value)!=null?p:null,value:k.value};return H(me,[...m!=null&&k.value!=null?Oe({[m]:k.value}).map(([L,ve])=>H(ye,Te({features:Ce.Hidden,key:L,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:C,name:L,value:ve}))):[],Z({theirProps:{...e,...ee($,["by","defaultValue","immediate","modelValue","multiple","nullable","onUpdate:modelValue","virtual"])},ourProps:{},slot:G,slots:c,attrs:e,name:"Combobox"})])}}}),tt=K({name:"ComboboxInput",props:{as:{type:[Object,String],default:"input"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},displayValue:{type:Function},defaultValue:{type:String,default:void 0},id:{type:String,default:null}},emits:{change:n=>!0},setup(n,{emit:c,attrs:e,slots:o,expose:t}){var i;let u=(i=n.id)!=null?i:`headlessui-combobox-input-${te()}`,l=U("ComboboxInput"),v=x(()=>Ee(T(l.inputRef))),f={value:!1};t({el:l.inputRef,$el:l.inputRef});function b(){l.change(null);let r=T(l.optionsRef);r&&(r.scrollTop=0),l.goToOption(P.Nothing)}let g=x(()=>{var r;let S=l.value.value;return T(l.inputRef)?typeof n.displayValue<"u"&&S!==void 0?(r=n.displayValue(S))!=null?r:"":typeof S=="string"?S:"":""});X(()=>{B([g,l.comboboxState,v],([r,S],[I,w])=>{if(f.value)return;let a=T(l.inputRef);a&&((w===0&&S===1||r!==I)&&(a.value=r),requestAnimationFrame(()=>{var z;if(f.value||!a||((z=v.value)==null?void 0:z.activeElement)!==a)return;let{selectionStart:s,selectionEnd:d}=a;Math.abs((d??0)-(s??0))===0&&s===0&&a.setSelectionRange(a.value.length,a.value.length)}))},{immediate:!0}),B([l.comboboxState],([r],[S])=>{if(r===0&&S===1){if(f.value)return;let I=T(l.inputRef);if(!I)return;let w=I.value,{selectionStart:a,selectionEnd:z,selectionDirection:s}=I;I.value="",I.value=w,s!==null?I.setSelectionRange(a,z,s):I.setSelectionRange(a,z)}})});let E=V(!1);function R(){E.value=!0}function M(){ne().nextFrame(()=>{E.value=!1})}function F(r){switch(f.value=!0,r.key){case A.Enter:if(f.value=!1,l.comboboxState.value!==0||E.value)return;if(r.preventDefault(),r.stopPropagation(),l.activeOptionIndex.value===null){l.closeCombobox();return}l.selectActiveOption(),l.mode.value===0&&l.closeCombobox();break;case A.ArrowDown:return f.value=!1,r.preventDefault(),r.stopPropagation(),j(l.comboboxState.value,{0:()=>l.goToOption(P.Next),1:()=>l.openCombobox()});case A.ArrowUp:return f.value=!1,r.preventDefault(),r.stopPropagation(),j(l.comboboxState.value,{0:()=>l.goToOption(P.Previous),1:()=>{l.openCombobox(),ue(()=>{l.value.value||l.goToOption(P.Last)})}});case A.Home:if(r.shiftKey)break;return f.value=!1,r.preventDefault(),r.stopPropagation(),l.goToOption(P.First);case A.PageUp:return f.value=!1,r.preventDefault(),r.stopPropagation(),l.goToOption(P.First);case A.End:if(r.shiftKey)break;return f.value=!1,r.preventDefault(),r.stopPropagation(),l.goToOption(P.Last);case A.PageDown:return f.value=!1,r.preventDefault(),r.stopPropagation(),l.goToOption(P.Last);case A.Escape:if(f.value=!1,l.comboboxState.value!==0)return;r.preventDefault(),l.optionsRef.value&&!l.optionsPropsRef.value.static&&r.stopPropagation(),l.nullable.value&&l.mode.value===0&&l.value.value===null&&b(),l.closeCombobox();break;case A.Tab:if(f.value=!1,l.comboboxState.value!==0)return;l.mode.value===0&&l.activationTrigger.value!==1&&l.selectActiveOption(),l.closeCombobox();break}}function D(r){c("change",r),l.nullable.value&&l.mode.value===0&&r.target.value===""&&b(),l.openCombobox()}function h(r){var S,I,w;let a=(S=r.relatedTarget)!=null?S:oe.find(z=>z!==r.currentTarget);if(f.value=!1,!((I=T(l.optionsRef))!=null&&I.contains(a))&&!((w=T(l.buttonRef))!=null&&w.contains(a))&&l.comboboxState.value===0)return r.preventDefault(),l.mode.value===0&&(l.nullable.value&&l.value.value===null?b():l.activationTrigger.value!==1&&l.selectActiveOption()),l.closeCombobox()}function O(r){var S,I,w;let a=(S=r.relatedTarget)!=null?S:oe.find(z=>z!==r.currentTarget);(I=T(l.buttonRef))!=null&&I.contains(a)||(w=T(l.optionsRef))!=null&&w.contains(a)||l.disabled.value||l.immediate.value&&l.comboboxState.value!==0&&(l.openCombobox(),ne().nextFrame(()=>{l.setActivationTrigger(1)}))}let k=x(()=>{var r,S,I,w;return(w=(I=(S=n.defaultValue)!=null?S:l.defaultValue.value!==void 0?(r=n.displayValue)==null?void 0:r.call(n,l.defaultValue.value):null)!=null?I:l.defaultValue.value)!=null?w:""});return()=>{var r,S,I,w,a,z,s;let d={open:l.comboboxState.value===0},{displayValue:p,onChange:m,...y}=n,C={"aria-controls":(r=l.optionsRef.value)==null?void 0:r.id,"aria-expanded":l.comboboxState.value===0,"aria-activedescendant":l.activeOptionIndex.value===null?void 0:l.virtual.value?(S=l.options.value.find($=>!l.virtual.value.disabled($.dataRef.value)&&l.compare($.dataRef.value,l.virtual.value.options[l.activeOptionIndex.value])))==null?void 0:S.id:(I=l.options.value[l.activeOptionIndex.value])==null?void 0:I.id,"aria-labelledby":(z=(w=T(l.labelRef))==null?void 0:w.id)!=null?z:(a=T(l.buttonRef))==null?void 0:a.id,"aria-autocomplete":"list",id:u,onCompositionstart:R,onCompositionend:M,onKeydown:F,onInput:D,onFocus:O,onBlur:h,role:"combobox",type:(s=e.type)!=null?s:"text",tabIndex:0,ref:l.inputRef,defaultValue:k.value,disabled:l.disabled.value===!0?!0:void 0};return Z({ourProps:C,theirProps:y,slot:d,attrs:e,slots:o,features:Y.RenderStrategy|Y.Static,name:"ComboboxInput"})}}}),lt=K({name:"ComboboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},hold:{type:[Boolean],default:!1}},setup(n,{attrs:c,slots:e,expose:o}){let t=U("ComboboxOptions"),i=`headlessui-combobox-options-${te()}`;o({el:t.optionsRef,$el:t.optionsRef}),J(()=>{t.optionsPropsRef.value.static=n.static}),J(()=>{t.optionsPropsRef.value.hold=n.hold});let u=Re(),l=x(()=>u!==null?(u.value&W.Open)===W.Open:t.comboboxState.value===0);return Pe({container:x(()=>T(t.optionsRef)),enabled:x(()=>t.comboboxState.value===0),accept(v){return v.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:v.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(v){v.setAttribute("role","none")}}),()=>{var v,f,b;let g={open:t.comboboxState.value===0},E={"aria-labelledby":(b=(v=T(t.labelRef))==null?void 0:v.id)!=null?b:(f=T(t.buttonRef))==null?void 0:f.id,id:i,ref:t.optionsRef,role:"listbox","aria-multiselectable":t.mode.value===1?!0:void 0},R=ee(n,["hold"]);return Z({ourProps:E,theirProps:R,slot:g,attrs:c,slots:t.virtual.value&&t.comboboxState.value===0?{...e,default:()=>[H(We,{},e.default)]}:e,features:Y.RenderStrategy|Y.Static,visible:l.value,name:"ComboboxOptions"})}}}),nt=K({name:"ComboboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1},order:{type:[Number],default:null}},setup(n,{slots:c,attrs:e,expose:o}){let t=U("ComboboxOption"),i=`headlessui-combobox-option-${te()}`,u=V(null);o({el:u,$el:u});let l=x(()=>{var h;return t.virtual.value?t.activeOptionIndex.value===t.calculateIndex(n.value):t.activeOptionIndex.value===null?!1:((h=t.options.value[t.activeOptionIndex.value])==null?void 0:h.id)===i}),v=x(()=>t.isSelected(n.value)),f=se(ce,null),b=x(()=>({disabled:n.disabled,value:n.value,domRef:u,order:x(()=>n.order)}));X(()=>t.registerOption(i,b)),be(()=>t.unregisterOption(i,l.value)),J(()=>{let h=T(u);h&&(f==null||f.value.measureElement(h))}),J(()=>{t.comboboxState.value===0&&l.value&&(t.virtual.value||t.activationTrigger.value!==0&&ue(()=>{var h,O;return(O=(h=T(u))==null?void 0:h.scrollIntoView)==null?void 0:O.call(h,{block:"nearest"})}))});function g(h){var O;if(n.disabled||(O=t.virtual.value)!=null&&O.disabled(n.value))return h.preventDefault();t.selectOption(i),we()||requestAnimationFrame(()=>{var k;return(k=T(t.inputRef))==null?void 0:k.focus({preventScroll:!0})}),t.mode.value===0&&requestAnimationFrame(()=>t.closeCombobox())}function E(){var h;if(n.disabled||(h=t.virtual.value)!=null&&h.disabled(n.value))return t.goToOption(P.Nothing);let O=t.calculateIndex(n.value);t.goToOption(P.Specific,O)}let R=ze();function M(h){R.update(h)}function F(h){var O;if(!R.wasMoved(h)||n.disabled||(O=t.virtual.value)!=null&&O.disabled(n.value)||l.value)return;let k=t.calculateIndex(n.value);t.goToOption(P.Specific,k,0)}function D(h){var O;R.wasMoved(h)&&(n.disabled||(O=t.virtual.value)!=null&&O.disabled(n.value)||l.value&&(t.optionsPropsRef.value.hold||t.goToOption(P.Nothing)))}return()=>{let{disabled:h}=n,O={active:l.value,selected:v.value,disabled:h},k={id:i,ref:u,role:"option",tabIndex:h===!0?void 0:-1,"aria-disabled":h===!0?!0:void 0,"aria-selected":v.value,disabled:void 0,onClick:g,onFocus:E,onPointerenter:M,onMouseenter:M,onPointermove:F,onMousemove:F,onPointerleave:D,onMouseleave:D},r=ee(n,["order","value"]);return Z({ourProps:k,theirProps:r,slot:O,attrs:e,slots:c,name:"ComboboxOption"})}}});export{et as Z,nt as a,lt as l,tt as o};
