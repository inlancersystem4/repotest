import{_ as g,r as f,o as r,c,g as _,a,t as w,F as y,b as S,f as b,w as M,n as L,j as u,i as k,e as C,E as A,B as O,C as F}from"./index-CObJ0xdd.js";import{L as I,D as B}from"./Default-BakE7Kt_.js";import{f as N}from"./list-fetch-Bs_JyIgH.js";import{i as $}from"./item-delete-BEr_XWGk.js";import{_ as V}from"./deleteicon-9Y-d_GsD.js";import"./transition-DmPYughZ.js";import"./dialog-Bwww8Fqq.js";import"./admin-logo-DCOArUCp.js";const E={data(){return{selectedDate:""}},computed:{formattedDate(){if(!this.selectedDate)return"";const t=new Date(this.selectedDate),e=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getDate()).padStart(2,"0"),s=`${e}-${i}-${n}`;return this.$emit("date_select",s),s}}},J={class:"opacity-0 -mt-12"};function U(t,e,i,n,s,l){const d=f("VDatePicker");return r(),c(y,null,[_(d,{modelValue:s.selectedDate,"onUpdate:modelValue":e[0]||(e[0]=h=>s.selectedDate=h)},null,8,["modelValue"]),a("p",J,w(l.formattedDate),1)],64)}const j=g(E,[["render",U]]),D="https://stagingapi.fandfrestaurants.com/admin",W={components:{LayoutWrapper:I,Calendar:j,DeleteModal:B},data(){return{alertStore:S(),availabilityId:"",availabilityList:[],deleteModal:!1,itemNameForDelete:"",searchErrorShow:!1,searchDate:"",addBtnLoading:!1,isMenuOpen:!1,isSearchMenuOpen:!1}},created(){this.fetchAvailabilityList()},mounted(){document.addEventListener("click",this.handleClickOutside)},beforeUnmount(){document.removeEventListener("click",this.handleClickOutside)},methods:{handleClickOutside(t){const e=this.$refs.menu,i=this.$refs.searchMenu;e&&!e.contains(t.target)&&(this.isMenuOpen=!1),i&&!i.contains(t.target)&&(this.isSearchMenuOpen=!1)},formatDate(t){const e=new Date(t),i=e.getDate(),n=e.getMonth(),s=e.getFullYear(),l=["th","st","nd","rd"],d=i%10<=3&&i%10>0?l[i%10]:l[0];return`${i}${d} ${["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][n]} ${s}`},selectedDateForSearch(t){this.searchDate=t,this.isSearchMenuOpen=!1,this.fetchAvailabilityList()},fetchAllAvailabilityList(){this.searchDate="",this.fetchAvailabilityList()},async fetchAvailabilityList(){this.searchErrorShow=!1;const t=new FormData;t.append("search",this.searchDate||"");const e=await N("availability-list",t);e&&e.data.availability_list.length!==0?this.availabilityList=e.data.availability_list:(this.searchDate&&(this.searchErrorShow=!0),this.availabilityList=[])},async deleteAvailability(){if(this.availabilityId){const t=new FormData;t.append("availability_id",this.availabilityId),await $("availability-remove",t)&&(this.fetchAvailabilityList(),this.closeDeleteModal())}},async statusUpdate(t,e){const i=new FormData;i.append("availability_id",t),i.append("availability_status_data",e);const n=await b.post(`${D}/availability-status`,i);n.success===1?this.fetchAvailabilityList():this.alertStore.error(n.message)},closeDeleteModal(){this.deleteModal=!1,this.availabilityId=""},deleteItem(t,e){this.deleteModal=!0,this.availabilityId=t;const i=new Date(e),n=i.getDate(),s=i.getMonth(),l=i.getFullYear(),d=["th","st","nd","rd"],h=n%10<=3&&n%10>0?d[n%10]:d[0],m=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];this.itemNameForDelete=`${n}${h} ${m[s]} ${l}`},async selectedDate(t){this.addBtnLoading=!0;const e=new FormData;e.append("availability_id",this.availabilityId||""),e.append("availability_date",t||this.searchDate||"");try{const i=await b.post(`${D}/availability-add`,e);i.success===1?(this.searchDate="",this.searchErrorShow=!1,this.isMenuOpen=!1,this.addBtnLoading=!1,this.fetchAvailabilityList()):(this.addBtnLoading=!1,this.alertStore.error(i.message))}catch(i){this.alertStore.error(i)}}}},p=t=>(O("data-v-268e6771"),t=t(),F(),t),z=p(()=>a("h2",{class:"modal--title"},"Availability",-1)),T={class:"w-full flex flex-col items-start space-y-14"},Y={class:"flex items-center justify-between w-full"},P={class:"relative",ref:"menu"},H=["disabled"],q={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},G=p(()=>a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1)),K=p(()=>a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)),Q=[G,K],R={key:0,class:"mt-2 absolute top-full left-0 shadow-lg"},X={class:"relative",ref:"searchMenu"},Z={as:"div"},ee={key:0,class:"mt-2 absolute top-full right-0 shadow-lg"},te={class:"w-full space-y-4 font-helveticav"},ae={class:"text-left text-base text-base-color min-w-[130px]"},se={class:"flex items-center gap-8"},ie={class:"flex items-center gap-3.5"},le=["for"],oe=["id","name","checked","onChange"],ne={class:"flex items-center gap-3.5"},re=["for"],ce=["id","name","checked","onChange"],de=["onClick"],he=p(()=>a("img",{src:V,alt:"delete date",class:"w-7 h-auto"},null,-1)),ue=[he],_e={key:0,class:"space-y-2.5"},pe=p(()=>a("p",{class:"text-base text-center text-primary-color"}," This Date is not Available in Availability ",-1)),fe=[pe],me={class:"flex items-stretch justify-center gap-1.5 flex-wrap"};function ye(t,e,i,n,s,l){const d=f("Calendar"),h=f("LayoutWrapper"),m=f("DeleteModal");return r(),c(y,null,[_(h,null,{default:M(()=>[a("form",{class:"max-w-lg mx-auto space-y-10 py-3",onSubmit:e[4]||(e[4]=A(o=>l.selectedDate(),["prevent"]))},[z,a("div",T,[a("div",Y,[a("div",P,[a("div",null,[a("button",{class:L(["modal--form_btn",{"btn--loader":s.addBtnLoading}]),type:"button",disabled:s.addBtnLoading,onClick:e[0]||(e[0]=o=>s.isMenuOpen=!s.isMenuOpen)},[s.addBtnLoading?(r(),c("svg",q,Q)):u("",!0),k(" Select Date ")],10,H),s.isMenuOpen?(r(),c("div",R,[_(d,{onDate_select:l.selectedDate},null,8,["onDate_select"])])):u("",!0)])],512),a("div",X,[a("div",Z,[a("button",{class:"btn--regular",type:"button",onClick:e[1]||(e[1]=o=>s.isSearchMenuOpen=!s.isSearchMenuOpen)}," Search Date "),s.isSearchMenuOpen?(r(),c("div",ee,[_(d,{onDate_select:l.selectedDateForSearch},null,8,["onDate_select"])])):u("",!0)])],512)]),a("ul",te,[(r(!0),c(y,null,C(s.availabilityList,(o,x)=>(r(),c("li",{class:"flex items-center justify-between w-full",key:x},[a("div",null,[a("p",ae,w(l.formatDate(o.availability_date)),1)]),a("div",se,[a("div",ie,[a("label",{class:"text-base text-base-color cursor-pointer",for:`close_${o.availability_id}`},"Close",8,le),a("input",{type:"radio",id:`close_${o.availability_id}`,name:`status_${o.availability_id}`,checked:o.availability_status==="1",onChange:v=>l.statusUpdate(o.availability_id,1)},null,40,oe)]),a("div",ne,[a("label",{class:"text-base text-base-color cursor-pointer",for:`full_${o.availability_id}`},"Full",8,re),a("input",{type:"radio",id:`full_${o.availability_id}`,name:`status_${o.availability_id}`,checked:o.availability_status==="2",onChange:v=>l.statusUpdate(o.availability_id,2)},null,40,ce)])]),a("div",null,[a("button",{type:"button",onClick:v=>l.deleteItem(o.availability_id,o.availability_date)},ue,8,de)])]))),128)),s.searchErrorShow?(r(),c("li",_e,fe)):u("",!0),a("li",me,[s.searchDate?(r(),c("button",{key:0,class:"btn--regular",onClick:e[2]||(e[2]=o=>l.fetchAllAvailabilityList()),type:"button"}," View All Availability ")):u("",!0),s.searchDate&&s.searchErrorShow?(r(),c("button",{key:1,class:"btn--regular",onClick:e[3]||(e[3]=o=>l.selectedDate()),type:"button"}," Save This Date ")):u("",!0)])])])],32)]),_:1}),_(m,{isDelete:s.deleteModal,item_name:s.itemNameForDelete,onClose_modal:l.closeDeleteModal,onDelete_item:l.deleteAvailability},null,8,["isDelete","item_name","onClose_modal","onDelete_item"])],64)}const Le=g(W,[["render",ye],["__scopeId","data-v-268e6771"]]);export{Le as default};
