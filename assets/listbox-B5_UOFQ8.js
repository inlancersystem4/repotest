import{l as S,m,k as j,H as W,q as E,p as U,v as N,F as G,J as X,I as Y,K as Z,bk as L,aO as A}from"./index-CObJ0xdd.js";import{u as D,w as _,c as ee,h as te,o as y,t as le,a as V,f as ae,m as oe,s as ne,d as B,p as ie,I as F,l as ue,e as z,O as re,g as b}from"./dialog-Bwww8Fqq.js";import{f as se,c as h,s as ve,p as de,u as pe}from"./use-text-value-C2hDVVix.js";function ce(t,u,i){let g=S(i==null?void 0:i.value),s=m(()=>t.value!==void 0);return[m(()=>s.value?t.value:g.value),function(d){return s.value||(g.value=d),u==null?void 0:u(d)}]}function K(t={},u=null,i=[]){for(let[g,s]of Object.entries(t))H(i,q(u,g),s);return i}function q(t,u){return t?t+"["+u+"]":u}function H(t,u,i){if(Array.isArray(i))for(let[g,s]of i.entries())H(t,q(u,g.toString()),s);else i instanceof Date?t.push([u,i.toISOString()]):typeof i=="boolean"?t.push([u,i?"1":"0"]):typeof i=="string"?t.push([u,i]):typeof i=="number"?t.push([u,`${i}`]):i==null?t.push([u,""]):K(i,u,t)}function fe(t,u){return t===u}var be=(t=>(t[t.Open=0]="Open",t[t.Closed=1]="Closed",t))(be||{}),me=(t=>(t[t.Single=0]="Single",t[t.Multi=1]="Multi",t))(me||{}),xe=(t=>(t[t.Pointer=0]="Pointer",t[t.Other=1]="Other",t))(xe||{});function ge(t){requestAnimationFrame(()=>requestAnimationFrame(t))}let Q=Symbol("ListboxContext");function C(t){let u=Z(Q,null);if(u===null){let i=new Error(`<${t} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(i,C),i}return u}let Se=j({name:"Listbox",emits:{"update:modelValue":t=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],default:()=>fe},horizontal:{type:[Boolean],default:!1},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},form:{type:String,optional:!0},name:{type:String,optional:!0},multiple:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(t,{slots:u,attrs:i,emit:g}){let s=S(1),d=S(null),e=S(null),x=S(null),p=S([]),c=S(""),f=S(null),a=S(1);function n(l=o=>o){let o=f.value!==null?p.value[f.value]:null,r=re(l(p.value.slice()),O=>y(O.dataRef.domRef)),v=o?r.indexOf(o):null;return v===-1&&(v=null),{options:r,activeOptionIndex:v}}let w=m(()=>t.multiple?1:0),[k,R]=ce(m(()=>t.modelValue),l=>g("update:modelValue",l),m(()=>t.defaultValue)),$=m(()=>k.value===void 0?D(w.value,{1:[],0:void 0}):k.value),P={listboxState:s,value:$,mode:w,compare(l,o){if(typeof t.by=="string"){let r=t.by;return(l==null?void 0:l[r])===(o==null?void 0:o[r])}return t.by(l,o)},orientation:m(()=>t.horizontal?"horizontal":"vertical"),labelRef:d,buttonRef:e,optionsRef:x,disabled:m(()=>t.disabled),options:p,searchQuery:c,activeOptionIndex:f,activationTrigger:a,closeListbox(){t.disabled||s.value!==1&&(s.value=1,f.value=null)},openListbox(){t.disabled||s.value!==0&&(s.value=0)},goToOption(l,o,r){if(t.disabled||s.value===1)return;let v=n(),O=se(l===h.Specific?{focus:h.Specific,id:o}:{focus:l},{resolveItems:()=>v.options,resolveActiveIndex:()=>v.activeOptionIndex,resolveId:T=>T.id,resolveDisabled:T=>T.dataRef.disabled});c.value="",f.value=O,a.value=r??1,p.value=v.options},search(l){if(t.disabled||s.value===1)return;let o=c.value!==""?0:1;c.value+=l.toLowerCase();let r=(f.value!==null?p.value.slice(f.value+o).concat(p.value.slice(0,f.value+o)):p.value).find(O=>O.dataRef.textValue.startsWith(c.value)&&!O.dataRef.disabled),v=r?p.value.indexOf(r):-1;v===-1||v===f.value||(f.value=v,a.value=1)},clearSearch(){t.disabled||s.value!==1&&c.value!==""&&(c.value="")},registerOption(l,o){let r=n(v=>[...v,{id:l,dataRef:o}]);p.value=r.options,f.value=r.activeOptionIndex},unregisterOption(l){let o=n(r=>{let v=r.findIndex(O=>O.id===l);return v!==-1&&r.splice(v,1),r});p.value=o.options,f.value=o.activeOptionIndex,a.value=1},theirOnChange(l){t.disabled||R(l)},select(l){t.disabled||R(D(w.value,{0:()=>l,1:()=>{let o=L(P.value.value).slice(),r=L(l),v=o.findIndex(O=>P.compare(r,L(O)));return v===-1?o.push(r):o.splice(v,1),o}}))}};_([e,x],(l,o)=>{var r;P.closeListbox(),ee(o,te.Loose)||(l.preventDefault(),(r=y(e))==null||r.focus())},m(()=>s.value===0)),W(Q,P),le(m(()=>D(s.value,{0:V.Open,1:V.Closed})));let I=m(()=>{var l;return(l=y(e))==null?void 0:l.closest("form")});return E(()=>{U([I],()=>{if(!I.value||t.defaultValue===void 0)return;function l(){P.theirOnChange(t.defaultValue)}return I.value.addEventListener("reset",l),()=>{var o;(o=I.value)==null||o.removeEventListener("reset",l)}},{immediate:!0})}),()=>{let{name:l,modelValue:o,disabled:r,form:v,...O}=t,T={open:s.value===0,disabled:r,value:$.value};return N(G,[...l!=null&&$.value!=null?K({[l]:$.value}).map(([M,J])=>N(ae,oe({features:ne.Hidden,key:M,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:v,name:M,value:J}))):[],B({ourProps:{},theirProps:{...i,...ie(O,["defaultValue","onUpdate:modelValue","horizontal","multiple","by"])},slot:T,slots:u,attrs:i,name:"Listbox"})])}}}),Le=j({name:"ListboxButton",props:{as:{type:[Object,String],default:"button"},id:{type:String,default:null}},setup(t,{attrs:u,slots:i,expose:g}){var s;let d=(s=t.id)!=null?s:`headlessui-listbox-button-${F()}`,e=C("ListboxButton");g({el:e.buttonRef,$el:e.buttonRef});function x(a){switch(a.key){case b.Space:case b.Enter:case b.ArrowDown:a.preventDefault(),e.openListbox(),A(()=>{var n;(n=y(e.optionsRef))==null||n.focus({preventScroll:!0}),e.value.value||e.goToOption(h.First)});break;case b.ArrowUp:a.preventDefault(),e.openListbox(),A(()=>{var n;(n=y(e.optionsRef))==null||n.focus({preventScroll:!0}),e.value.value||e.goToOption(h.Last)});break}}function p(a){switch(a.key){case b.Space:a.preventDefault();break}}function c(a){e.disabled.value||(e.listboxState.value===0?(e.closeListbox(),A(()=>{var n;return(n=y(e.buttonRef))==null?void 0:n.focus({preventScroll:!0})})):(a.preventDefault(),e.openListbox(),ge(()=>{var n;return(n=y(e.optionsRef))==null?void 0:n.focus({preventScroll:!0})})))}let f=ve(m(()=>({as:t.as,type:u.type})),e.buttonRef);return()=>{var a,n;let w={open:e.listboxState.value===0,disabled:e.disabled.value,value:e.value.value},{...k}=t,R={ref:e.buttonRef,id:d,type:f.value,"aria-haspopup":"listbox","aria-controls":(a=y(e.optionsRef))==null?void 0:a.id,"aria-expanded":e.listboxState.value===0,"aria-labelledby":e.labelRef.value?[(n=y(e.labelRef))==null?void 0:n.id,d].join(" "):void 0,disabled:e.disabled.value===!0?!0:void 0,onKeydown:x,onKeyup:p,onClick:c};return B({ourProps:R,theirProps:k,slot:w,attrs:u,slots:i,name:"ListboxButton"})}}}),Re=j({name:"ListboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},id:{type:String,default:null}},setup(t,{attrs:u,slots:i,expose:g}){var s;let d=(s=t.id)!=null?s:`headlessui-listbox-options-${F()}`,e=C("ListboxOptions"),x=S(null);g({el:e.optionsRef,$el:e.optionsRef});function p(a){switch(x.value&&clearTimeout(x.value),a.key){case b.Space:if(e.searchQuery.value!=="")return a.preventDefault(),a.stopPropagation(),e.search(a.key);case b.Enter:if(a.preventDefault(),a.stopPropagation(),e.activeOptionIndex.value!==null){let n=e.options.value[e.activeOptionIndex.value];e.select(n.dataRef.value)}e.mode.value===0&&(e.closeListbox(),A(()=>{var n;return(n=y(e.buttonRef))==null?void 0:n.focus({preventScroll:!0})}));break;case D(e.orientation.value,{vertical:b.ArrowDown,horizontal:b.ArrowRight}):return a.preventDefault(),a.stopPropagation(),e.goToOption(h.Next);case D(e.orientation.value,{vertical:b.ArrowUp,horizontal:b.ArrowLeft}):return a.preventDefault(),a.stopPropagation(),e.goToOption(h.Previous);case b.Home:case b.PageUp:return a.preventDefault(),a.stopPropagation(),e.goToOption(h.First);case b.End:case b.PageDown:return a.preventDefault(),a.stopPropagation(),e.goToOption(h.Last);case b.Escape:a.preventDefault(),a.stopPropagation(),e.closeListbox(),A(()=>{var n;return(n=y(e.buttonRef))==null?void 0:n.focus({preventScroll:!0})});break;case b.Tab:a.preventDefault(),a.stopPropagation();break;default:a.key.length===1&&(e.search(a.key),x.value=setTimeout(()=>e.clearSearch(),350));break}}let c=ue(),f=m(()=>c!==null?(c.value&V.Open)===V.Open:e.listboxState.value===0);return()=>{var a,n;let w={open:e.listboxState.value===0},{...k}=t,R={"aria-activedescendant":e.activeOptionIndex.value===null||(a=e.options.value[e.activeOptionIndex.value])==null?void 0:a.id,"aria-multiselectable":e.mode.value===1?!0:void 0,"aria-labelledby":(n=y(e.buttonRef))==null?void 0:n.id,"aria-orientation":e.orientation.value,id:d,onKeydown:p,role:"listbox",tabIndex:0,ref:e.optionsRef};return B({ourProps:R,theirProps:k,slot:w,attrs:u,slots:i,features:z.RenderStrategy|z.Static,visible:f.value,name:"ListboxOptions"})}}}),we=j({name:"ListboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1},id:{type:String,default:null}},setup(t,{slots:u,attrs:i,expose:g}){var s;let d=(s=t.id)!=null?s:`headlessui-listbox-option-${F()}`,e=C("ListboxOption"),x=S(null);g({el:x,$el:x});let p=m(()=>e.activeOptionIndex.value!==null?e.options.value[e.activeOptionIndex.value].id===d:!1),c=m(()=>D(e.mode.value,{0:()=>e.compare(L(e.value.value),L(t.value)),1:()=>L(e.value.value).some(l=>e.compare(L(l),L(t.value)))})),f=m(()=>D(e.mode.value,{1:()=>{var l;let o=L(e.value.value);return((l=e.options.value.find(r=>o.some(v=>e.compare(L(v),L(r.dataRef.value)))))==null?void 0:l.id)===d},0:()=>c.value})),a=de(x),n=m(()=>({disabled:t.disabled,value:t.value,get textValue(){return a()},domRef:x}));E(()=>e.registerOption(d,n)),X(()=>e.unregisterOption(d)),E(()=>{U([e.listboxState,c],()=>{e.listboxState.value===0&&c.value&&D(e.mode.value,{1:()=>{f.value&&e.goToOption(h.Specific,d)},0:()=>{e.goToOption(h.Specific,d)}})},{immediate:!0})}),Y(()=>{e.listboxState.value===0&&p.value&&e.activationTrigger.value!==0&&A(()=>{var l,o;return(o=(l=y(x))==null?void 0:l.scrollIntoView)==null?void 0:o.call(l,{block:"nearest"})})});function w(l){if(t.disabled)return l.preventDefault();e.select(t.value),e.mode.value===0&&(e.closeListbox(),A(()=>{var o;return(o=y(e.buttonRef))==null?void 0:o.focus({preventScroll:!0})}))}function k(){if(t.disabled)return e.goToOption(h.Nothing);e.goToOption(h.Specific,d)}let R=pe();function $(l){R.update(l)}function P(l){R.wasMoved(l)&&(t.disabled||p.value||e.goToOption(h.Specific,d,0))}function I(l){R.wasMoved(l)&&(t.disabled||p.value&&e.goToOption(h.Nothing))}return()=>{let{disabled:l}=t,o={active:p.value,selected:c.value,disabled:l},{value:r,disabled:v,...O}=t,T={id:d,ref:x,role:"option",tabIndex:l===!0?void 0:-1,"aria-disabled":l===!0?!0:void 0,"aria-selected":c.value,disabled:void 0,onClick:w,onFocus:k,onPointerenter:$,onMouseenter:$,onPointermove:P,onMousemove:P,onPointerleave:I,onMouseleave:I};return B({ourProps:T,theirProps:O,slot:o,attrs:i,slots:u,name:"ListboxOption"})}}});export{Re as A,we as F,Se as I,ce as d,K as e,Le as j};
