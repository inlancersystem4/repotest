import{_ as M,r as u,o as l,d as _,w as f,c as n,t as i,j as d,a as e,F as v,e as L,i as D,b as V,f as T,g,y as w,G as k,n as P,E as N,B as O,C as F}from"./index-CObJ0xdd.js";import{f as S}from"./list-fetch-Bs_JyIgH.js";import{i as E}from"./item-delete-BEr_XWGk.js";import{L as G,D as U}from"./Default-BakE7Kt_.js";import{C as j}from"./CommonModalLayout-BJWFpzOf.js";import{S as B}from"./SingleSelect-RiIrTQOv.js";import{Z as W,o as z,l as q,a as R}from"./combobox-wrqH_vu8.js";import{P as Z}from"./Pagination-vvzSV-Y8.js";import"./transition-DmPYughZ.js";import"./dialog-Bwww8Fqq.js";import"./admin-logo-DCOArUCp.js";import"./listbox-B5_UOFQ8.js";import"./use-text-value-C2hDVVix.js";import"./use-tree-walker-BsBza9zE.js";const H={components:{Combobox:W,ComboboxInput:z,ComboboxOptions:q,ComboboxOption:R},data(){return{countryCodeList:[],selectedcountry:""}},created(){this.fetchCountryCodeList()},props:{selectCountryData:Object},methods:{async fetchCountryCodeList(t){var s=new FormData;s.append("search",t||"");const c=await S("country-phone-code-list",s);c&&c.data.length!==0?this.countryCodeList=c.data.countries_list:this.countryCodeList=""},selectedCountryValue(t){this.$emit("selected_country",t)},removeCountryValue(){this.$emit("selected_country",""),this.selectedcountry=""}}},Y={key:0,class:"flex items-center gap-1.5 px-2 min-h-[44px] max-h-[44px] justify-between"},J={key:0,class:"line-clamp-1 text-nowrap block"},K={key:1,class:"line-clamp-1 text-nowrap block"},Q=e("p",{class:"!text-center"},"Oops, data not found!",-1);function X(t,s,c,I,o,a){const C=u("ComboboxInput"),y=u("ComboboxOption"),p=u("ComboboxOptions"),m=u("Combobox");return l(),_(m,{modelValue:o.selectedcountry,"onUpdate:modelValue":s[2]||(s[2]=r=>o.selectedcountry=r),class:"custom--select",as:"div"},{default:f(()=>[c.selectCountryData.name||o.selectedcountry.name?(l(),n("div",Y,[c.selectCountryData.name?(l(),n("span",J,i(c.selectCountryData.code)+" - "+i(c.selectCountryData.name),1)):d("",!0),o.selectedcountry?(l(),n("span",K,i(o.selectedcountry.phonecode)+" - "+i(o.selectedcountry.name),1)):d("",!0),e("button",{type:"button",onClick:s[0]||(s[0]=(...r)=>a.removeCountryValue&&a.removeCountryValue(...r))},"x")])):d("",!0),!c.selectCountryData.name&&!o.selectedcountry.name?(l(),_(C,{key:1,placeholder:"Search",onInput:s[1]||(s[1]=r=>a.fetchCountryCodeList(r.target.value)),class:"!border-none"})):d("",!0),o.countryCodeList&&o.countryCodeList.length>0?(l(),_(p,{key:2,class:"select--option min-w-[250px]"},{default:f(()=>[(l(!0),n(v,null,L(o.countryCodeList,r=>(l(),_(y,{key:r.id,value:r,class:"option",onClick:x=>a.selectedCountryValue(r)},{default:f(()=>[D(i(r.phonecode)+" - "+i(r.name),1)]),_:2},1032,["value","onClick"]))),128))]),_:1})):(l(),_(p,{key:3,class:"select--option min-w-[250px]"},{default:f(()=>[Q]),_:1}))]),_:1},8,["modelValue"])}const $=M(H,[["render",X]]),ee="https://stagingapi.fandfrestaurants.com/admin",te={props:{isOpen:Boolean,customerData:Object},components:{CommonModalLayout:j,SingleSelect:B,CountryCodeSelect:$},data(){return{alertStore:V(),btnLoading:!1,formName:"",fName:"",mNumber:"",customerID:"",formSubmitted:!1,selectedGender:"",selectedCountry:"",selectCountryData:{},genderArray:[{name:"Mr."},{name:"Mrs."}]}},watch:{customerData(t){t?this.updatecustomerData():this.clearFields()},isOpen(){this.customerData&&this.customerData.user_customer_name?this.formName="Edit Customer  - "+this.customerData.user_customer_name:this.formName="Add a Customer"}},created(){this.updatecustomerData()},methods:{closeModal(){this.$emit("close_modal")},updatecustomerData(){this.customerData&&(this.customerID=this.customerData.user_id,this.fName=this.customerData.user_customer_name,this.mNumber=this.customerData.user_customer_mobile_no,this.selectedGender=this.customerData.user_customer_gender||"Mr.",this.selectCountryData={name:this.customerData.user_customer_country_name||"Saudi Arabia",code:this.customerData.user_customer_country_code||"966"},this.selectedCountry=this.customerData.user_customer_country_code_id||"194")},clearFields(){this.customerID="",this.mNumber="",this.selectedCountry="",this.selectedGender="",this.selectCountryData={},this.formSubmitted=!1},selectGender(t){this.selectedGender=t.name},selectCountry(t){t?this.selectedCountry=t.id:(this.selectedCountry="",this.selectCountryData={})},async updateCustomer(){if(this.formSubmitted=!0,this.btnLoading=!0,!this.selectedGender||!this.fName||!this.mNumber||!this.selectedCountry){this.btnLoading=!1;return}var t=new FormData;this.customerID?t.append("user_id",this.customerID):t.append("user_id",""),t.append("user_customer_gender",this.selectedGender),t.append("user_customer_name",this.fName),t.append("user_customer_country_code",this.selectedCountry||""),t.append("user_customer_mobile_no",this.mNumber);try{const s=await T.post(`${ee}/customer-add`,t);s.success==1?(this.$emit("close_modal",1),this.clearFields(),this.btnLoading=!1):(this.btnLoading=!1,this.alertStore.error(s.message))}catch(s){this.alertStore.error(s)}}}},b=t=>(O("data-v-ded5dd3d"),t=t(),F(),t),se={class:"space-y-3 w-full"},oe={class:"space-y-1"},re={class:"input--group"},ae=b(()=>e("label",{for:"fName"},[D("Full name"),e("span",{class:"text-red-600"},"*")],-1)),le={class:"flex items-stretch gap-1.5 w-full"},ce={class:"input--group"},ie=b(()=>e("label",null,null,-1)),ne={key:0,class:"error--message !text-left flex-1"},ue={class:"space-y-1"},me={class:"input--group"},de=b(()=>e("label",{for:"mNumber"},[D("Mobile"),e("span",{class:"text-red-600"},"*")],-1)),_e={class:"flex items-stretch gap-1.5 w-full"},he={class:"input--group"},pe=b(()=>e("label",null,null,-1)),fe={key:0,class:"error--message !text-left flex-1"},be=["disabled"],Ce={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},ye=b(()=>e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1)),ge=b(()=>e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)),xe=[ye,ge];function De(t,s,c,I,o,a){const C=u("SingleSelect"),y=u("CountryCodeSelect"),p=u("CommonModalLayout");return l(),_(p,{isOpen:c.isOpen,modal_title:o.formName,onClose_modal:a.closeModal,manualClass:"customer--modal max-w-xl !overflow-visible"},{default:f(()=>[e("form",{class:"space-y-10 flex w-full flex-col items-end",onSubmit:s[2]||(s[2]=N((...m)=>a.updateCustomer&&a.updateCustomer(...m),["prevent"]))},[e("div",se,[e("div",oe,[e("div",re,[ae,e("div",le,[g(C,{items:o.genderArray,selectLabel:"gender",placeholderText:"Select Gender",onReceiveData:a.selectGender,class:"max-w-[120px]",selectedValueEdit:this.selectedGender},null,8,["items","onReceiveData","selectedValueEdit"]),w(e("input",{type:"text",id:"fName","onUpdate:modelValue":s[0]||(s[0]=m=>o.fName=m)},null,512),[[k,o.fName,void 0,{trim:!0}]])])]),e("div",ce,[ie,o.formSubmitted&&!o.fName?(l(),n("p",ne," full name is required ")):d("",!0)])]),e("div",ue,[e("div",me,[de,e("div",_e,[g(y,{class:"max-w-[120px]",onSelected_country:a.selectCountry,selectCountryData:o.selectCountryData},null,8,["onSelected_country","selectCountryData"]),w(e("input",{type:"number",id:"mNumber","onUpdate:modelValue":s[1]||(s[1]=m=>o.mNumber=m)},null,512),[[k,o.mNumber,void 0,{trim:!0}]])])]),e("div",he,[pe,o.formSubmitted&&!o.mNumber?(l(),n("p",fe," Mobile Number is required ")):d("",!0)])])]),e("button",{class:P(["modal--form_btn",{"btn--loader":o.btnLoading}]),type:"submit",disabled:o.btnLoading},[o.btnLoading?(l(),n("svg",Ce,xe)):d("",!0),D(" Save ")],10,be)],32)]),_:1},8,["isOpen","modal_title","onClose_modal"])}const ve=M(te,[["render",De],["__scopeId","data-v-ded5dd3d"]]),Le={components:{LayoutWrraper:G,Pagination:Z,CustomerForm:ve,DeleteModal:U},data(){return{alertStore:V(),customerList:[],currentPage:1,totalPages:1,skeletonEffect:!0,customerId:"",itemNameforDelete:"",premiumModal:!1,searchParams:"",customerID:"",customIsPremium:"",CustomerModal:!1,customerData:{},totalCustomer:"",totalPremiumCustomer:"",activeList:"all"}},created(){this.$route.params.search&&(this.searchParams=this.$route.params.search),this.fetchCustomerList()},computed:{premiumCustomersTotal(){return this.customerList.filter(t=>t.user_customer_is_premium==1)}},methods:{searchCustomer(){this.searchParams?(this.$router.push({name:"adminCustomers",params:{search:this.searchParams}}),this.fetchCustomerList()):(this.$router.push({name:"adminCustomers",params:{search:""}}),this.fetchCustomerList())},closePremiumModal(){this.premiumModal=!1,this.customerID=""},updatePage(t){this.currentPage=t,this.fetchCustomerList()},closeCustomerModal(t){this.CustomerModal=!1,this.customerData={},t&&this.fetchCustomerList()},customerPremiumToggle(t,s){t&&(s==1?this.customIsPremium="customersPremium1":this.customIsPremium="customersPremium0",this.customerID=t,this.premiumModal=!0)},async premiumUser(){if(this.customerID){var t=new FormData;t.append("user_id",this.customerID),await E("premium-status",t)?(this.fetchCustomerList(),this.customerID="",this.closePremiumModal()):this.closeDeleteModal()}},async fetchCustomerList(){this.skeletonEffect=!0;var t=new FormData;t.append("search",this.searchParams),t.append("page",this.currentPage);const s=await S("customer-list",t);s&&s.data.length!==0?(this.customerList=s.data.customer_lists,this.skeletonEffect=!1,this.totalPages=s.data.total_pages,this.totalCustomer=s.data.all_customer,this.totalPremiumCustomer=s.data.premium_customer):(this.customerList="",this.skeletonEffect=!1)},selectAllTab(){this.activeList="all",this.fetchCustomerList()},selectPremiumTab(){this.activeList="premium";const t=this.customerList.filter(s=>s.user_customer_is_premium==1);this.customerList=t},async updateCustomer(t){var s=new FormData;s.append("user_id",t);try{const c=await S("customer-details",s);c&&c.success==1&&(this.customerData=c.data,this.CustomerModal=!0)}catch(c){this.alertStore.error(c)}}}},h=t=>(O("data-v-d1198678"),t=t(),F(),t),we={class:"border-x border-solid border-base-color h-full py-6 custom-container px-8"},ke={class:"py-6 border-b border-solid border-base-color pb-6 space-y-6"},Pe={class:"flex items-end justify-between w-full gap-4"},Ne={class:"flex items-stretch gap-2.5"},Se=h(()=>e("button",{type:"submit",class:"btn--regular fill"},"Search",-1)),Me={class:"py-6 space-y-8"},Ie={class:"table costing--table"},Ve=h(()=>e("tr",null,[e("th",{class:"name"},"Customer Name"),e("th",{class:"mNumber"},"Mobile Number"),e("th",{class:"nVisit"},"Number of Visits"),e("th",{class:"action"},"premium")],-1)),Oe=h(()=>e("td",{class:"name"},[e("div",{class:"effect"},[e("span",{class:"bg-base-color h-4 rounded-md w-[240px] block"})])],-1)),Fe=h(()=>e("td",{class:"mNumber"},[e("div",{class:"effect"},[e("span",{class:"bg-base-color h-4 ml-auto rounded-md w-[180px] block"})])],-1)),Ae=h(()=>e("td",{class:"nVisit"},[e("div",{class:"effect space-y-1 text-end"},[e("span",{class:"bg-base-color h-4 ml-auto rounded-md w-[40px] block"})])],-1)),Te=h(()=>e("td",{class:"action"},[e("div",{class:"effect flex items-center justify-start flex-wrap gap-1.5"},[e("span",{class:"bg-base-color h-4 rounded-md w-[42px] block"})])],-1)),Ee=[Oe,Fe,Ae,Te],Ge={key:1},Ue=h(()=>e("td",{colspan:"4",class:"!text-center"},"No Data Available",-1)),je=[Ue],Be=["onClick"],We={class:"name"},ze={class:"mNumber !text-right"},qe={class:"nVisit !text-right"},Re=["onClick"],Ze={key:0,class:"flex items-center justify-center w-full mt-8"};function He(t,s,c,I,o,a){const C=u("Pagination"),y=u("DeleteModal"),p=u("CustomerForm"),m=u("LayoutWrraper");return l(),_(m,null,{default:f(()=>[e("section",we,[e("div",ke,[e("div",Pe,[e("div",Ne,[e("button",{type:"button",class:P(["btn--regular",{"!bg-base-color !text-white":o.activeList==="all"}]),onClick:s[0]||(s[0]=(...r)=>a.selectAllTab&&a.selectAllTab(...r))}," All Customers("+i(o.totalCustomer)+") ",3),e("button",{type:"button",class:P(["btn--regular",{"!bg-base-color !text-white":o.activeList==="premium"}]),onClick:s[1]||(s[1]=(...r)=>a.selectPremiumTab&&a.selectPremiumTab(...r))}," Premium("+i(o.totalPremiumCustomer)+") ",3)]),e("button",{type:"button",class:"btn--regular",onClick:s[2]||(s[2]=r=>this.CustomerModal=!this.CustomerModal)}," Add ")]),e("form",{class:"w-full max-w-xl flex flex-col !items-end gap-4 mx-auto input--group",onSubmit:s[4]||(s[4]=N((...r)=>a.searchCustomer&&a.searchCustomer(...r),["prevent"]))},[w(e("input",{type:"text",class:"text-center","onUpdate:modelValue":s[3]||(s[3]=r=>o.searchParams=r),placeholder:"Search Customer here...."},null,512),[[k,o.searchParams,void 0,{trim:!0}]]),Se],32)]),e("div",Me,[e("table",Ie,[Ve,o.skeletonEffect?(l(),n(v,{key:0},L(10,(r,x)=>e("tr",{class:"animate-pulse",key:x},Ee)),64)):o.customerList&&o.customerList.length===0?(l(),n("tr",Ge,je)):(l(!0),n(v,{key:2},L(o.customerList,(r,x)=>(l(),n("tr",{key:x,class:"cursor-pointer",onClick:A=>a.updateCustomer(r.user_id)},[e("td",We,i(r.user_customer_gender)+" "+i(r.user_customer_name),1),e("td",ze,i(r.user_customer_country_code)+i(r.user_customer_mobile_no),1),e("td",qe,i(r.user_customer_number_of_visits),1),e("td",{class:"action",onClick:N(A=>a.customerPremiumToggle(r.user_id,r.user_customer_is_premium),["stop"])},[e("button",null,i(r.user_customer_is_premium==1?"YES":"NO"),1)],8,Re)],8,Be))),128))]),o.customerList&&o.customerList.length!==0?(l(),n("div",Ze,[g(C,{currentPage:o.currentPage,totalPages:o.totalPages,onUpdate_page:a.updatePage},null,8,["currentPage","totalPages","onUpdate_page"])])):d("",!0)])]),g(y,{isDelete:o.premiumModal,item_name:o.customIsPremium,onClose_modal:a.closePremiumModal,onDelete_item:a.premiumUser},null,8,["isDelete","item_name","onClose_modal","onDelete_item"]),g(p,{isOpen:o.CustomerModal,customerData:o.customerData,onClose_modal:a.closeCustomerModal},null,8,["isOpen","customerData","onClose_modal"])]),_:1})}const it=M(Le,[["render",He],["__scopeId","data-v-d1198678"]]);export{it as default};
